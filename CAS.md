# CAS #
2019-03-08 16:55:33 
## 1.CAS(乐观锁:假设不会发生并发冲突,提交时检查是否违反数据完整性,失败会重试) ##
**一种高效实现线程安全性的方法**

- 支持原子更新操作,适用于计数器,序列发生器等场景  
- 属于乐观锁,号称lock-free
- CAS操作失败时由开发者决定是继续尝试,还是执行别的操作


## 2.CAS思想 ##
包含3个操作数:内存地址(V),旧的预期值A,更新的目标值B

**CAS指令执行时,当且仅当内存地址V的值与旧的预期值A一样时,就将内存地址V的值更新为B,否则就什么都不做.整个比较并替换是一个原子操作**

CAS多数情况下对开发者来说是透明的:  
1.J.U.C的atomic包提供了常用的原子性数据类型以及引用,数组等相关原子类型和更新操作工具,是很多线程安全程序的首选  

2.Unsafe类虽然提供了CAS服务,但是因为能够任意内存地址读写而存在隐患

3.java9以后,可以使用Variable Handle API来替代Unsafe类


## 3.CAS的缺点 ##
- 若循环时间长,则开销很大
- 只能保证一个共享变量的原子操作
- ABA问题   **解决:AtomicStampedReference**
